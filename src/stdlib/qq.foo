;; A crude quasiquote type deal.

(define (quasiquote-expand expr)
  (cond ((tagged-list? 'quasiquote expr) (list 'list expr))
        ((tagged-list? 'unquote expr) (list 'list (cadr expr)))
        ((tagged-list? 'unquote-splicing expr) (cadr expr))
        ((pair? expr) (cons 'append (map quasiquote-expand expr)))
        ('else (list 'list (list 'quote expr)))))

(define (quasiquote-macro expr)
  (quasiquote-expand (cadr expr)))
